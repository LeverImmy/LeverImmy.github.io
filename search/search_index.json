{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout 1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"\u4e3b\u9875"},{"location":"#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"#project-layout","text":"1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"Project layout"},{"location":"posts/about/friends/","text":"\u6821\u5185\u597d\u53cb id \u535a\u5ba2\u5730\u5740 CJ_Tracer link imzzy link EternalAlexander link Polaris_Dane link Polyethylene link \u5357\u6c99\u5ba2\u8fd0\u6e2f link \u6821\u5916\u597d\u53cb id \u535a\u5ba2\u5730\u5740 DestinHistoire link","title":"\u53cb\u60c5\u94fe\u63a5"},{"location":"posts/about/friends/#_1","text":"id \u535a\u5ba2\u5730\u5740 CJ_Tracer link imzzy link EternalAlexander link Polaris_Dane link Polyethylene link \u5357\u6c99\u5ba2\u8fd0\u6e2f link","title":"\u6821\u5185\u597d\u53cb"},{"location":"posts/about/friends/#_2","text":"id \u535a\u5ba2\u5730\u5740 DestinHistoire link","title":"\u6821\u5916\u597d\u53cb"},{"location":"posts/about/myself/","text":"\u4e2a\u4eba\u4ecb\u7ecd \u6211\u662f Clever_Jimmy\uff0c\u4e00\u540d\u6765\u81ea HB \u7684\u5df2\u7ecf\u9000\u5f79\u7684 OIer\u3002 \u5907\u5fd8\u5f55 \u591a\u5199\u6ce8\u91ca\uff1b LaTeX \u6307\u5357 link \u300c\u4e5f\u8bb8\uff0c\u540c\u5b66\u95f4\u6700\u597d\u7684\u7ed3\u5c40\u5c31\u662f\u670b\u53cb\u5427\u3002\u300d \u540e\u7f00\u6811\u5efa\u9020\u8fc7\u7a0b link \u300c\u4f60\u81ea\u5df1\u624d\u662f\u81ea\u5df1\u7684\u539f\u52a8\u529b\u3002\u4f60\u628a\u539f\u52a8\u529b\u90fd\u6390\u7184\u706b\u4e86\uff0c\u8fd8\u80fd\u5e72\u561b\u5462\uff1f\u300d \u5934\u50cf\u7f51\u5740 link \u7b97\u6cd5\u53ca\u6570\u636e\u7ed3\u6784\u53ef\u89c6\u5316 link \u5404\u5927 OJ \u901a\u8fc7\u6570\u7edf\u8ba1 link QQ \u8868\u60c5\u56fe\u5e8a\u5730\u5740 link SVG \u56fe\u50cf\u7ed8\u5236 link \u53d6\u6a21\u4e58\u6cd5\uff1a 1 2 3 4 5 int mul ( int ta , int tb , int mod ) { int ret ; __asm__ __volatile__ ( \" \\t mull %%ebx \\n\\t divl %%ecx \\n \" : \"=d\" ( ret ) : \"a\" ( ta ), \"b\" ( tb ), \"c\" ( mod )); return ret ; } \u5927\u4e8b\u796d \u65e5\u671f \u4e8b\u60c5 2018.07.01 \u6210\u529f \u796d 2018.11.11 \u5b8c\u6210\u7b2c\u4e00\u6b21 NOIP \u796d 2019.11.17 \u5b8c\u6210\u7b2c\u4e00\u6b21 CSP \u796d 2020.01.01 \u5931\u8d25 \u796d 2020.01.23 \u6b66\u6c49\u5c01\u57ce\u796d 2020.03.10 CF \u4e0a 1800 \u796d 2020.03.22 \u7b2c\u4e00\u6b21 AK ABC \u796d 2020.03.30 \u7b2c\u4e00\u6b21\u4e0a \u6d1b\u8c37\u65e5\u62a5 \u796d 2020.06.08 CF Candidate Master \u796d 2020.06.12 \u7b2c\u4e00\u6b21 CF Successful Hack \u796d \uff08 hack \u7684\u8fd8\u662f\u81ea\u5df1\uff09 2020.06.12 CF \u4e0a 2000 \u796d 2020.06.14 \u7b2c\u4e00\u6b21 \u4e3e\u529e\u6d1b\u8c37\u516c\u5f00\u8d5b EasY Round \u796d 2020.08.01 AFO","title":"\u5173\u4e8e\u6211"},{"location":"posts/about/myself/#_1","text":"\u6211\u662f Clever_Jimmy\uff0c\u4e00\u540d\u6765\u81ea HB \u7684\u5df2\u7ecf\u9000\u5f79\u7684 OIer\u3002","title":"\u4e2a\u4eba\u4ecb\u7ecd"},{"location":"posts/about/myself/#_2","text":"\u591a\u5199\u6ce8\u91ca\uff1b LaTeX \u6307\u5357 link \u300c\u4e5f\u8bb8\uff0c\u540c\u5b66\u95f4\u6700\u597d\u7684\u7ed3\u5c40\u5c31\u662f\u670b\u53cb\u5427\u3002\u300d \u540e\u7f00\u6811\u5efa\u9020\u8fc7\u7a0b link \u300c\u4f60\u81ea\u5df1\u624d\u662f\u81ea\u5df1\u7684\u539f\u52a8\u529b\u3002\u4f60\u628a\u539f\u52a8\u529b\u90fd\u6390\u7184\u706b\u4e86\uff0c\u8fd8\u80fd\u5e72\u561b\u5462\uff1f\u300d \u5934\u50cf\u7f51\u5740 link \u7b97\u6cd5\u53ca\u6570\u636e\u7ed3\u6784\u53ef\u89c6\u5316 link \u5404\u5927 OJ \u901a\u8fc7\u6570\u7edf\u8ba1 link QQ \u8868\u60c5\u56fe\u5e8a\u5730\u5740 link SVG \u56fe\u50cf\u7ed8\u5236 link \u53d6\u6a21\u4e58\u6cd5\uff1a 1 2 3 4 5 int mul ( int ta , int tb , int mod ) { int ret ; __asm__ __volatile__ ( \" \\t mull %%ebx \\n\\t divl %%ecx \\n \" : \"=d\" ( ret ) : \"a\" ( ta ), \"b\" ( tb ), \"c\" ( mod )); return ret ; }","title":"\u5907\u5fd8\u5f55"},{"location":"posts/about/myself/#_3","text":"\u65e5\u671f \u4e8b\u60c5 2018.07.01 \u6210\u529f \u796d 2018.11.11 \u5b8c\u6210\u7b2c\u4e00\u6b21 NOIP \u796d 2019.11.17 \u5b8c\u6210\u7b2c\u4e00\u6b21 CSP \u796d 2020.01.01 \u5931\u8d25 \u796d 2020.01.23 \u6b66\u6c49\u5c01\u57ce\u796d 2020.03.10 CF \u4e0a 1800 \u796d 2020.03.22 \u7b2c\u4e00\u6b21 AK ABC \u796d 2020.03.30 \u7b2c\u4e00\u6b21\u4e0a \u6d1b\u8c37\u65e5\u62a5 \u796d 2020.06.08 CF Candidate Master \u796d 2020.06.12 \u7b2c\u4e00\u6b21 CF Successful Hack \u796d \uff08 hack \u7684\u8fd8\u662f\u81ea\u5df1\uff09 2020.06.12 CF \u4e0a 2000 \u796d 2020.06.14 \u7b2c\u4e00\u6b21 \u4e3e\u529e\u6d1b\u8c37\u516c\u5f00\u8d5b EasY Round \u796d 2020.08.01 AFO","title":"\u5927\u4e8b\u796d"},{"location":"posts/articles/","text":"index","title":"\u6982\u8ff0"},{"location":"posts/articles/#index","text":"","title":"index"},{"location":"posts/articles/2020-08/","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout 1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"2020-08"},{"location":"posts/articles/2020-08/#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"posts/articles/2020-08/#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"posts/articles/2020-08/#project-layout","text":"1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"Project layout"},{"location":"posts/editorials/","text":"index","title":"\u6982\u8ff0"},{"location":"posts/editorials/#index","text":"","title":"index"},{"location":"posts/editorials/atcoder/","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout 1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"AtCoder"},{"location":"posts/editorials/atcoder/#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"posts/editorials/atcoder/#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"posts/editorials/atcoder/#project-layout","text":"1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"Project layout"},{"location":"posts/editorials/bzoj/","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout 1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"BZOJ"},{"location":"posts/editorials/bzoj/#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"posts/editorials/bzoj/#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"posts/editorials/bzoj/#project-layout","text":"1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"Project layout"},{"location":"posts/editorials/codeforces/","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout 1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"CodeForces"},{"location":"posts/editorials/codeforces/#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"posts/editorials/codeforces/#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"posts/editorials/codeforces/#project-layout","text":"1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"Project layout"},{"location":"posts/editorials/luogu/","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout 1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"\u6d1b\u8c37"},{"location":"posts/editorials/luogu/#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"posts/editorials/luogu/#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"posts/editorials/luogu/#project-layout","text":"1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"Project layout"},{"location":"posts/editorials/poj/","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout 1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"POJ"},{"location":"posts/editorials/poj/#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"posts/editorials/poj/#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"posts/editorials/poj/#project-layout","text":"1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"Project layout"},{"location":"posts/lectures/","text":"index","title":"\u6982\u8ff0"},{"location":"posts/lectures/#index","text":"","title":"index"},{"location":"posts/lectures/ac-automaton/","text":"","title":"AC \u81ea\u52a8\u673a"},{"location":"posts/lectures/dlx/","text":"","title":"Dancing Links"},{"location":"posts/lectures/eertree/","text":"","title":"\u56de\u6587\u6811"},{"location":"posts/lectures/kmp/","text":"\u53d1\u73b0\u81ea\u5df1\u4e0d\u4f1a KMP \u7684\u6a21\u677f\u4e86\uff0c\u501f\u6b64\u673a\u4f1a\u590d\u4e60\u4e00\u4e0b KMP\uff0c\u987a\u4fbf\u66f4\u6df1\u5165\u5730\u7814\u7a76\u524d\u7f00\u51fd\u6570 \\(\\pi\\) \u7684\u5e94\u7528\u3002 \u5199\u5728\u524d\u9762 \u4e3a\u4e86\u66f4\u65b9\u4fbf\u5730\u63cf\u8ff0\u5b57\u7b26\u4e32\u76f8\u5173\u5185\u5bb9\uff0c\u6211\u4eec\u505a\u51fa\u4ee5\u4e0b\u89c4\u5b9a\uff1a \u5b57\u7b26\u4e32\u901a\u5e38\u7528 \\(S, T\\) \u7b49\u8868\u793a\uff0c \\(c\\) \u901a\u5e38\u8868\u793a\u4e00\u4e2a\u5b57\u7b26\uff0c \\(\\Sigma\\) \u8868\u793a\u5b57\u7b26\u96c6\uff1b \u5b57\u7b26\u4e32\u957f\u5ea6\u7528 \\(\\left|S\\right|\\) \u8868\u793a\uff1b \u5b57\u7b26\u96c6\u5927\u5c0f\u7528 \\(\\left|\\Sigma\\right|\\) \u8868\u793a\uff1b \\(S[l..r]\\) \u8868\u793a \\(S[l], S[l + 1], \\ldots, S[r - 1], S[r]\\) \uff1b \u7a7a\u4e32\u7528 \\(\\epsilon\\) \u8868\u793a\uff1b \\(S\\) \u662f \\(T\\) \u7684\u524d\u7f00\uff0c\u7528 \\(S \\sqsubset T\\) \u8868\u793a\uff1b \\(S\\) \u662f \\(T\\) \u7684\u540e\u7f00\uff0c\u7528 \\(S \\sqsupset T\\) \u8868\u793a\uff1b \\(S\\) \u7684\u7b2c \\(i\\) \u4e2a\u524d\u7f00\uff0c\u5373 \\(S[1..i]\\) \uff0c\u7528 \\(S_i\\) \u8868\u793a\u3002 \u7279\u6b8a\u5730\uff0c\u672c\u6587\u7684\u5b57\u7b26\u4e32\u4e0b\u6807\u3001 \\(\\pi\\) \u6570\u7ec4\u4e0b\u6807 \u5747\u4ece \\(1\\) \u5f00\u59cb \u3002 \u4e00\u4e9b\u4f8b\u5b50 \u5bf9\u4e8e \\(S = \\mathtt{ABCBAD}\\) \u800c\u8a00\uff1a \\(\\left|S\\right| = 6\\) \uff1b \\(\\left|\\Sigma\\right| = 4\\) \uff1b \\(S[2..4] = \\mathtt{BCBA}\\) \uff1b \\(S_4 = \\mathtt{ABCB}\\) \u3002 \u524d\u7f00\u51fd\u6570\u6570\u7ec4 \u5b9a\u4e49 \u5bf9\u4e8e\u4e00\u4e2a\u5b57\u7b26\u4e32 \\(S\\) \uff0c\u6211\u4eec\u5b9a\u4e49\u5176\u524d\u7f00\u51fd\u6570 \\(\\pi(S)\\) \u7684\u503c\u4e3a \\(S\\) \u7684\u6700\u957f\u76f8\u7b49\u7684\u771f\u524d\u7f00\u548c\u771f\u540e\u7f00\u7684\u957f\u5ea6\uff0c\u5373\uff1a \\[ \\begin{aligned} \\pi(S) & = \\mathop{\\operatorname{argmax}}\\limits_{k < \\left|S\\right|}\\{S[1..k] = S[\\left|S\\right| - k + 1..\\left|S\\right|]\\} \\\\ & = \\mathop{\\operatorname{argmax}}\\limits_{k < \\left|S\\right|}\\{S_k \\sqsupset S\\} \\end{aligned} \\] \u5bf9\u4e8e\u4e00\u4e2a\u5b57\u7b26\u4e32 \\(S\\) \uff0c\u6211\u4eec\u5b9a\u4e49\u5176\u524d\u7f00\u51fd\u6570\u6570\u7ec4 \\(\\pi\\) \u4e3a \\(\\pi[i] = \\pi(S_i)\\) \u3002 \\(\\pi[1] = ?\\) \u7279\u6b8a\u5730\uff0c\u5f53 \\(\\left|S\\right| = 1\\) \u65f6 \\(\\pi(S) = \\mathop{\\operatorname{argmax}}\\limits_{k < 1}\\{S[1..k] = S[2 - k..1]\\}\\) \u6b64\u65f6\u6709 \\(k = 0\\) \u6ee1\u8db3 \\(S[1..0] = S[2..1] = \\epsilon\\) \uff0c\u6545 \\(\\left|S\\right| = 1 \\Longrightarrow \\pi(S) = 0\\) \u3002 \u6027\u8d28 1 \\(\\pi(S_i) = \\pi[i] < i\\) \u3002 \u8bc1\u660e \u7531\u5b9a\u4e49\u77e5 \\(\\pi[i] < i\\) \uff0c\u5373\u5f97\u8bc1\u3002 \u7b97\u6cd5\u6d41\u7a0b \u6839\u636e\u5b9a\u4e49\uff0c \\(\\pi[1] = 0\\) \uff1b \u5047\u8bbe\u6211\u4eec\u5faa\u73af\u5230\u4e86\u8981\u6c42 \\(\\pi[i]\\quad(i \\ge 2)\\) \uff0c\u4ee4 \\(k \\gets \\pi[i - 1]\\) \u3002 \u7531 \\(\\pi\\) \u6570\u7ec4\u7684\u5b9a\u4e49\u5f97\uff0c\u6b64\u65f6 \\(S[1..k] = S[i - k, i - 1]\\) \u3002 \u6211\u4eec\u73b0\u5728\u8981\u505a\u7684\uff0c\u5c31\u662f\u4ece \\(\\pi[1..i - 1]\\) \u9012\u63a8\u5230 \\(\\pi[i]\\) \uff1a \u8003\u8651\u5230 \\(\\pi\\) \u6570\u7ec4\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u4e0d\u65ad\u5730\u679a\u4e3e\u5171\u540c\u7684\u524d\u540e\u7f00\uff08\u5373\u4f7f\u7528 \\(k = \\pi[k]\\) \u6765\u8fed\u4ee3\uff09\u3002 \u7ed3\u675f\u8fd9\u4e2a\u8fed\u4ee3\uff0c\u6709\u4e14\u4ec5\u6709\u4e24\u79cd\u60c5\u51b5\uff1a \\(k = 0\\) \u6216 \\(S[k + 1] = S[i]\\) \u3002 \u5bf9\u4e8e\u524d\u8005\uff0c\u8bf4\u660e\u5bf9\u4e8e\u5b57\u7b26\u4e32 \\(S[1..i]\\) \uff0c\u4e0d\u5b58\u5728\u4efb\u4f55\u4e24\u4e2a\u771f\u524d\u7f00\u4e0e\u771f\u540e\u7f00\u76f8\u540c\uff0c \\(\\pi[i] = 0\\) \u3002 \u5bf9\u4e8e\u540e\u8005\uff0c\u8bf4\u660e\u6211\u4eec\u627e\u5230\u4e86\u4e00\u4e2a \\(k\\) \uff0c\u4f7f\u5f97 \\(S[1..k + 1] = S[i - k..i]\\) \uff0c\u6839\u636e\u5b9a\u4e49\uff0c\u6709 \\(\\pi[i] = k + 1\\) \u3002 \u81f3\u6b64\uff0c\u6211\u4eec\u6c42\u51fa\u4e86\u5b57\u7b26\u4e32 \\(S\\) \u7684\u524d\u7f00\u51fd\u6570\u6570\u7ec4 \\(\\pi\\) \u3002 \u4ee3\u7801\u5b9e\u73b0 1 2 3 4 5 6 7 8 9 10 11 void calcPi ( char * S ) { pi [ 1 ] = 0 ; int len = strlen ( S + 1 ); for ( int i = 2 , k = 0 ; i <= len ; ++ i ) { while ( k > 0 && S [ k + 1 ] != S [ i ]) k = pi [ k ]; if ( S [ k + 1 ] == S [ i ]) ++ k ; pi [ i ] = k ; } } \u6b63\u786e\u6027 \u5f15\u7406 1\uff08\u540e\u7f00\u91cd\u53e0\u5f15\u7406\uff09 \u5bf9\u4e8e \\(x, y\\) \u6ee1\u8db3 \\(x \\sqsupset z, y \\sqsupset z\\) \u800c\u8a00\uff0c\u6709\uff1a \u82e5 \\(\\left|x\\right| \\le \\left|y\\right|\\) \uff0c\u5219 \\(x \\sqsupset y\\) \uff1b \u82e5 \\(\\left|x\\right| \\ge \\left|y\\right|\\) \uff0c\u5219 \\(y \\sqsupset x\\) \uff1b \u82e5 \\(\\left|x\\right| = \\left|y\\right|\\) \uff0c\u5219 \\(x = y\\) \u3002 \u8bc1\u660e \u8fc7\u4e8e\u663e\u7136\uff0c\u8bc1\u660e\u7565\u3002 \u8bbe \\[ \\pi^{\\star}[q] = \\\\{\\pi[q], \\pi^{(2)}[q], \\cdots, \\pi^{(t)}[q]\\\\} \\] \u5176\u4e2d \\[ \\pi^{(i)}[q] = \\begin{cases}q & i = 0 \\\\\\\\ \\pi[\\pi^{(i - 1)}[q]] & i \\ge 1\\end{cases} \\] \u5f53 \\(\\pi^{(t)}[q] = 0\\) \u65f6 \\(\\pi^{\\star}[q]\\) \u4e2d\u7684\u5e8f\u5217\u7ec8\u6b62\u3002 \u5f15\u7406 2\uff08\u524d\u7f00\u51fd\u6570\u8fed\u4ee3\u5f15\u7406\uff09 \u5bf9\u4efb\u610f\u957f\u5ea6\u4e3a \\(n\\) \u7684\u5b57\u7b26\u4e32 \\(S\\) \uff0c\u6709 \\[ \\forall q \\in [1, n], \\pi^{\\star}[q] = \\{k: k < q \\land S_k \\sqsupset S_q\\} \\] \u8bc1\u660e \u5148\u8bc1\u660e \\(\\pi^{\\star}[q] \\subseteq \\{k:k < q \\land S_k \\sqsupset S_q\\}\\) \uff0c \u5373\u8bc1\u660e \\(\\forall x \\in \\pi^{\\star}[q], x < q \\land S_x \\sqsupset S_q\\) \u3002 \u4efb\u53d6 \\(x \\in \\pi^{\\star}[q]\\) \uff0c\u4e0d\u59a8\u8bbe \\(x = \\pi^{u}[q] \\quad (u > 0)\\) \uff0c\u4e0b\u9762\u901a\u8fc7\u5bf9 \\(u\\) \u7684\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u660e\u547d\u9898\u6210\u7acb\u3002 \uff08\u57fa\u7840\uff09\u5f53 \\(u = 1\\) \u65f6\uff0c \\(x = \\pi[q]\\) \uff0c\u7531 \\(\\pi\\) \u6570\u7ec4\u7684\u5b9a\u4e49\u53ef\u77e5 \\(\\pi[q] < q \\land S_{\\pi[q]} \\sqsupset S_q\\) \u3002 \uff08\u5047\u8bbe\uff09\u5047\u8bbe\u5f53 \\(u = v\\) \u65f6 \\(\\pi^{v}[q] < q \\land S_{\\pi^{v}[q]} \\sqsupset S_q\\) \u3002 \uff08\u63a8\u5bfc\uff09\u5219\u5f53 \\(u = v + 1\\) \u65f6\uff0c \\(\\pi^{v + 1}[q] = \\pi[\\pi^{v}[q]] < \\pi^{v}[q] < q\\) \uff08\u6027\u8d28 1\uff09\uff1b \\(S_{\\pi^{v + 1}[q]} \\sqsupset S_{\\pi^{v}[q]} \\sqsupset S_q\\) \uff08\u7531\u6027\u8d28 1 \u5f97\u5230\u4e0b\u6807\u7684\u5927\u5c0f\u5173\u7cfb\uff0c\u7531\u5f15\u7406 1 \u5f97\u5230\u524d\u7f00\u4e4b\u95f4\u7684\u5173\u7cfb\uff09 \u56e0\u6b64 \\(\\forall x \\in \\pi^{\\star}[q], x < q \\land S_x \\sqsupset S_q\\) \u3002 \u518d\u8bc1\u660e \\(\\{k:k < q \\land S_k \\sqsupset S_q\\} \\subseteq \\pi^{\\star}[q]\\) \uff0c \u5373\u8bc1\u660e \\(\\forall x \\in \\\\{k:k < q \\land S_x \\sqsupset S_q\\\\}, x \\in\\pi^{\\star}[q]\\) \u8003\u8651\u4f7f\u7528\u53cd\u8bc1\u6cd5\u6765\u8bc1\u660e\u547d\u9898\u6210\u7acb\u3002 \u5047\u8bbe\u96c6\u5408 \\(M = \\{k:k < q \\land S_k \\sqsupset S_q\\} - \\pi^{\\star}[q]\\) \u975e\u7a7a\uff0c \\(j\\) \u662f \\(M\\) \u4e2d\u7684\u6700\u5927\u503c\u3002 \\(\\because\\) \\(\\pi[q]\\) \u662f \\(\\{k:k < q \\land S_x \\sqsupset S_q\\}\\) \u4e2d\u7684\u6700\u5927\u503c\uff0c\u4e14 \\(j \\in \\{k:k < q \\land S_x \\sqsupset S_q\\}\\) \\(\\therefore j < \\pi[q], S_j \\sqsupset S_q\\) \u53c8 \\(\\because \\pi[q] \\in \\pi^{\\star}[q]\\) \\(\\therefore \\exists j' \\in \\pi^{\\star}[q], \\text{s.t. }j' > j\\) \u8bbe \\(j'\\) \u8868\u793a \\(\\pi^{\\star}[q]\\) \u4e2d\u6bd4 \\(j\\) \u5927\u7684\u6700\u5c0f\u6574\u6570\u3002 \\(\\because \\{k:k < q \\land S_k \\sqsupset S_q\\} \\subseteq \\pi^{\\star}[q]\\) \u4e14 \\(j' \\in \\pi^{\\star}[q]\\) \\(\\therefore S_{j'} \\sqsupset S_q\\) \\(\\because j' > j\\) \u4e14 \\(j\\) \u662f\u5c0f\u4e8e \\(j'\\) \u7684\u6700\u5927\u503c \\(\\therefore S_j \\sqsupset S_{j'}\\) \uff08\u5f15\u7406 1\uff09 \u7531 \\(\\pi\\) \u6570\u7ec4\u7684\u5b9a\u4e49\u77e5 \\(\\pi[j'] = j\\) \\(\\because j' \\in \\pi^{\\star}[q]\\) \\(\\therefore j = \\pi[j'] \\in \\pi^{\\star}[q]\\) \uff0c\u4e0e\u5047\u8bbe\u77db\u76fe \u56e0\u6b64 \\(\\{k:k < q \\land S_k \\sqsupset S_q\\} \\subseteq \\pi^{\\star}[q]\\) \u3002 \u7efc\u4e0a\u6240\u8ff0\uff0c\u5bf9\u4efb\u610f\u957f\u5ea6\u4e3a \\(n\\) \u7684\u5b57\u7b26\u4e32 \\(S\\) \uff0c\u6709 \\(\\forall q \\in [1, n], \\pi^{\\star}[q] = \\{k: k < q \\land S_k \\sqsupset S_q\\}\\) \u3002 \u5f15\u7406 3 \u5bf9\u4efb\u610f\u957f\u5ea6\u4e3a \\(n\\) \u7684\u5b57\u7b26\u4e32 \\(S\\) \uff0c\u6709 \\(\\forall q \\in [1, n]\\) \uff0c\u82e5 \\(\\pi[q] > 0\\) \uff0c\u5219 \\(\\pi[q] - 1 \\in \\pi^{\\star}[q - 1]\\) \u3002 \u8bc1\u660e \u4ee4 \\(x = \\pi[q] > 0\\) \uff0c\u5219 \\(x < q, S_x \\sqsupset S_q\\) \\(\\because x > 0\\) \uff0c\u5219 \\(x - 1\\) \u6709\u610f\u4e49 \\(\\therefore x - 1 < q - 1, S_{x - 1} \\sqsupset S_{q - 1}\\) \uff08\u628a \\(S_x\\) \u548c \\(S_q\\) \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u53bb\u6389\uff09 \u7531\u5f15\u7406 2 \u77e5 \\(x - 1 \\in \\pi^{\\star}[q - 1]\\) \\(\\therefore \\forall q \\in [1, n] \\land \\pi[q] > 0,\\pi[q] - 1 \\in \\pi^{\\star}[q - 1]\\) \u5bf9 \\(q \\in [2, n]\\) \u5b9a\u4e49\u5b50\u96c6 \\(E_{q - i} \\subseteq \\pi^{\\star}[q - 1]\\) \u4e3a\uff1a \\[ E_{q - 1} = \\{k\\in\\pi^{\\star}[q - 1]:S_{k + 1} = S_k\\} \\] \u5219\u6709\uff1a \\[ \\begin{aligned} E_{q - 1} & = \\{k\\in\\pi^{\\star}[q - 1]:S_{k + 1} = S_k\\} \\\\ & = \\{k: k < q - 1, S_k \\sqsupset S_{q - 1}, S[k + 1] = S[q]\\} \\\\ & = \\{k: k < q - 1, S_{k + 1} \\sqsupset S_q\\} \\end{aligned} \\] \u56e0\u6b64\uff0c \\(E_{q - 1}\\) \u662f\u7531 \\(\\pi^{\\star}[q - 1]\\) \u4e2d\u7684\u503c\u7ec4\u6210\u7684\u3001\u80fd\u6ee1\u8db3 \\(S_{k + 1}\\) \u4e0e \\(S_q\\) \u7684\u67d0\u4e2a\u540e\u7f00\u76f8\u7b49\u7684 \\(k\\) \u7ec4\u6210\u7684\u96c6\u5408\u3002 \u63a8\u8bba 1 \u5bf9\u4efb\u610f\u957f\u5ea6\u4e3a \\(n\\) \u7684\u5b57\u7b26\u4e32 \\(S\\) \uff0c\u6709 \\[ \\forall q \\in [2, n],\\pi[q] = \\begin{cases}0 & E_{q - 1} = \\varnothing \\\\ 1 + \\max\\{k \\in E_{q - 1}\\} & E_{q - 1} \\neq \\varnothing\\end{cases} \\] \u8bc1\u660e \u5f53 \\(E_{q - 1} = \\varnothing\\) \u65f6\uff0c\u4e0d\u5b58\u5728\u4efb\u4f55\u4e00\u4e2a \\(k \\in \\pi^{\\star}[q - 1]\\) \uff0c\u4f7f\u5f97 \\(S_{k + 1} \\sqsupset S_q\\) \u3002 \u663e\u7136\u6b64\u65f6 \\(\\pi[q]\\) \u53ea\u80fd\u4e3a \\(0\\) \u3002 \u5f53 \\(E_{q - 1} \\neq \\varnothing\\) \u65f6\uff0c \\(\\forall k \\in E_{q - 1}, k < q - 1 \\land S_{k + 1} \\sqsupset S_q \\Longrightarrow k + 1 < q\\) \u5219\u7531 \\(\\pi[q]\\) \u7684\u5b9a\u4e49\uff0c \\(k\\) \u662f\u62d3\u5c55\u5230 \\(S_q\\) \u7684\u67d0\u4e00\u540e\u7f00\u7684\u5907\u9009\u9879\uff0c \\(\\pi[q] \\ge 1 + \\max\\{k \\in E_{q - 1}\\}\\) \u3002 \u6ce8\u610f\u5230\u6b64\u65f6 \\(\\pi[q] > 0\\) \uff0c\u8bbe \\(r = \\pi[q] - 1\\) \u3002 \u5219 \\(r + 1 = \\pi[q] < q, S_{r + 1} = S_{\\pi[q]} \\sqsupset S_q\\) \u3002 \\(\\because r + 1 > 0\\) \\(\\therefore S_{r + 1} = S_q\\) \u7531\u5f15\u7406 3 \u53ef\u5f97 \\(r = \\pi[q] - 1 \\in \\pi^{\\star}[q - 1]\\) \\(\\therefore r \\in E_{q - 1}\\) \\(\\therefore \\pi[q] - 1 = r \\le \\max\\{k \\in E_{q - 1}\\}\\) \u5373 \\(\\pi[q] \\le 1 + \\max\\{k \\in E_{q - 1}\\}\\) \u7efc\u4e0a\u6240\u8ff0\uff0c\u5f53 \\(E_{q - 1} \\neq \\varnothing\\) \uff0c \\(\\pi[q] = 1 + \\max\\{k \\in E_{q - 1}\\}\\) \u3002 \u518d\u6765\u770b\u770b\u4ee3\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 void calcPi ( char * S ) { pi [ 1 ] = 0 ; int len = strlen ( S + 1 ); for ( int i = 2 , k = 0 ; i <= len ; ++ i ) { while ( k > 0 && S [ k + 1 ] != S [ i ]) k = pi [ k ]; if ( S [ k + 1 ] == S [ i ]) ++ k ; pi [ i ] = k ; } } \u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u4f7f\u7528\u5faa\u73af\u4e0d\u53d8\u5f0f\u6765\u8bc1\u660e\u4e0a\u8ff0\u4ee3\u7801\u7684\u6b63\u786e\u6027\u3002 \u8bc1\u660e \u521d\u59cb\u5316 \u5728\u7b2c 4 \u884c\u7684\u8fed\u4ee3\u5f00\u59cb\u524d\uff0c\u6709 \\(i = 1, k = \\pi[i] = 0\\) \uff0c\u4e0d\u53d8\u5f0f\u6210\u7acb\u3002 \u4fdd\u6301 \u5728\u6bcf\u6b21\u8fed\u4ee3\u5f00\u59cb\u524d\uff0c\u6709 \\(k = \\pi[i - 1]\\) \uff1a \u82e5\u662f\u7b2c\u4e00\u6b21\u8fed\u4ee3\uff0c\u6b64\u7b49\u5f0f\u7531\u7b2c 4 \u884c\u4fdd\u8bc1\uff1b \u5176\u4f59\u8fed\u4ee3\u5747\u7531\u7b2c 9 \u884c\u4fdd\u8bc1\u3002 \u63a5\u4e0b\u6765\u8981\u8bc1\u660e\u6bcf\u6b21\u8fed\u4ee3\u7ed3\u675f\u540e\u5747\u6709 \\(k = \\pi[i]\\) \u6210\u7acb\u3002 \u82e5 \\(k \\neq \\pi[i]\\) \uff0c\u5219\u4f1a\u5728\u7b2c 5-8 \u884c\u5c06 \\(k\\) \u8c03\u6574\u81f3 \\(\\pi[i]\\) \u3002 \u7b2c 5 \u884c\u7684 while \u5faa\u73af\u904d\u5386\u6bcf\u4e00\u4e2a \\(k \\in \\pi^{\\star}[i - 1]\\) \uff0c\u76f4\u81f3\u627e\u5230\u4e00\u4e2a \\(k\\) \uff0c\u4f7f\u5f97 \\(S[k + 1] = S[i]\\) \u3002\uff08\u5f15\u7406 2\uff09 \u82e5\u627e\u4e0d\u5230\u8fd9\u6837\u7684\u503c\uff0c\u5219\u5728\u7b2c 7 \u884c \\(k = 0\\) \u3002 \u82e5\u627e\u5230\u4e86\u8fd9\u6837\u7684\u503c\uff0c\u6b64\u65f6 \\(k\\) \u4e3a\u6ee1\u8db3\u6761\u4ef6\u7684\u96c6\u5408\u4e2d\u7684\u6700\u5927\u503c\uff0c\u5e94\u5c06 \\(\\pi[i] \\gets k + 1\\) \u3002\uff08\u63a8\u8bba 1\uff09 \u7b2c 9 \u884c\u7684\u8d4b\u503c\u8bed\u53e5\u4f7f\u5f97 \\(k = \\pi[i]\\) \u6052\u6210\u7acb\u3002 \u7ec8\u6b62 \u5f53 \\(i = n + 1\\) \u65f6\uff0c\u8fed\u4ee3\u7ec8\u6b62\uff0c\u6b64\u65f6\u6211\u4eec\u6c42\u51fa\u4e86 \\(\\pi[1..n]\\) \u3002 \u81f3\u6b64\uff0c\u7b97\u6cd5\u7ed3\u675f\u3002 \u56e0\u6b64\uff0c\u4e0a\u8ff0\u4ee3\u7801\u5b9e\u73b0\u80fd\u6b63\u786e\u5730\u6c42\u51fa\u5b57\u7b26\u4e32 \\(S\\) \u7684\u524d\u7f00\u51fd\u6570\u6570\u7ec4\u3002 \u65f6\u95f4\u590d\u6742\u5ea6 \u4e0d\u96be\u53d1\u73b0\uff0c\u7b2c 7-9 \u884c\u4ee3\u7801\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5747\u4e3a \\(O(n)\\) \uff0c\u552f\u4e00\u68d8\u624b\u7684\u662f\u7b2c 6-7 \u884c\u4ee3\u7801\u3002 \u8003\u8651 \\(k\\) \u7684\u53d8\u5316\uff0c \\(k\\) \u5728\u7b2c 7-8 \u884c\u589e\u52a0\u7684\u6b21\u6570\u4e0d\u8d85\u8fc7 \\(n\\) \u6b21\uff0c\u5373 \\(k \\le n\\) \uff1b \\(k\\) \u5728\u7b2c 6 \u884c\u7684\u64cd\u4f5c\u4e2d\uff0c\u56e0\u4e3a\u6709 \\(\\pi(S_i) < i\\) \u7684\u6027\u8d28\uff0c\u5bfc\u81f4\u6bcf\u6b21\u8fed\u4ee3\u81f3\u5c11\u4f7f \\(k\\) \u51cf\u5c0f \\(1\\) \uff0c\u5373\u6700\u591a\u8fed\u4ee3 \\(n\\) \u6b21\u3002 \u7efc\u4e0a\u6240\u8ff0\uff0c\u7528\u4e0a\u8ff0\u65b9\u6cd5\u6c42\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u524d\u7f00\u51fd\u6570\u6570\u7ec4\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(n)\\) \u3002 \u7a7a\u95f4\u590d\u6742\u5ea6 \u6613\u77e5\u7528\u6b64\u79cd\u65b9\u6cd5\u6c42\u524d\u7f00\u51fd\u6570\u6570\u7ec4\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(n)\\) \u3002 KMP \u7b97\u6cd5 \u7b97\u6cd5\u6d41\u7a0b \u6211\u4eec\u4e3e\u4e00\u4e2a\u4f8b\u5b50\uff1a\u7528 \\(S = \\mathtt{CCFCCFMONEY}\\) \u88ab \\(T = \\mathtt{CCFCCFSB}\\) \u5339\u914d\u3002 \u6211\u4eec\u5b9a\u4e49\u4e24\u4e2a\u6307\u9488 \\(i,k\\) \uff0c\u8868\u793a \\(S[i - k..i - 1] = T[1..k]\\) \u3002 \u6211\u4eec\u8981\u62d3\u5c55\u7684\uff0c\u5c31\u662f \\(S[i]\\) \u4e0e \\(T[k + 1]\\) \u4e4b\u95f4\u7684\u5173\u7cfb\u3002 \u9996\u5148\u6211\u4eec\u8003\u8651\u6734\u7d20\u7b97\u6cd5\u7684\u5f0a\u7aef\uff1a\u5f53\u4f60\u5339\u914d\u5230\u4e86 \\(i = 8, k = 7\\) \u65f6\uff1a $$ \\begin{aligned} S & = \\mathtt{\\color{green}CCFXCCF\\color{red}M\\color{black}ONEY} \\\\ T & = \\mathtt{\\color{green}CCFXCCF\\color{red}S\\color{black}B} \\\\ \\text{index} & =\\mathtt{123456789} \\end{aligned} $$ \u4f60\u53d1\u73b0 \\(S[i] = S[8] = \\mathtt{M}\\) \uff0c\u53ef \\(T[k + 1] = T[8] = \\mathtt{S}\\) \uff0c\u6211\u4eec\u524d\u529f\u5c3d\u5f03\uff0c\u53ea\u80fd\u5c06 \\(T\\) \u5f80\u53f3\u5e73\u79fb\u4e00\u683c\u3002 \u800c\u4e14\u8981\u91cd\u65b0\u5f00\u59cb\uff1a \\(i = 1, k = 1\\) \u3002 $$ \\begin{aligned} S & = \\mathtt{CCFXCCFMONEY} \\\\ T & = \\mathtt{\\text{ }CCFXCCFSB} \\\\ \\text{index} & =\\mathtt{123456789} \\end{aligned} $$ \u663e\u7136\u6734\u7d20\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(nm)\\) \u3002 \u518d\u8003\u8651\u4f7f\u7528\u524d\u7f00\u51fd\u6570 \\(\\pi\\) \u6765\u4f18\u5316\u5339\u914d\u7684\u8fc7\u7a0b\u3002 \u4e0d\u96be\u6c42\u51fa \\(T\\) \u7684\u524d\u7f00\u6570\u7ec4 \\(\\pi[1..n] = \\\\{0, 1, 0, 0, 1, 2, 3, 0, 0\\\\}\\) \u3002 \u8003\u8651\u524d\u7f00\u6570\u7ec4\u7684\u610f\u4e49\uff1a \\(T_i\\) \u7684\u6700\u957f\u7684\u76f8\u7b49\u7684\u524d\u540e\u7f00\u957f\u5ea6\u3002 \u4f60\u77e5\u9053\u4e86\u5f53 \\(i = 8, k = 7\\) \u65f6\uff0c\u6709 \\(S[1..7] = T[1..7]\\) \uff0c\u800c\u4e14 \\(T[1..3] = T[5..7]\\) \u3002 \u5728\u4e0a\u8ff0\u7684\u4f8b\u5b50\u4e2d\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u53ef\u4ee5\u628a \\(T[1..3]\\) \u8fd9\u4e2a\u5730\u65b9\u5339\u914d\u5230\u7684 \\(\\mathtt{\\color{green}CCF}\\) \u79fb\u52a8\u5230 \\(S[5..8]\\) \u53bb\u3002 \u8fd9\u6837\u5c31\u76f4\u63a5\u8282\u7701\u4e86\u4e09\u6b21\u79fb\u52a8\u3002 \u603b\u7ed3\u4e00\u4e0b\u4f7f\u7528\u524d\u7f00\u51fd\u6570 \\(\\pi\\) \u65f6\u6211\u4eec\u7684\u5339\u914d\u8fc7\u7a0b\uff1a \u4f7f\u7528 \\(i, k\\) \u6765\u8868\u793a\u5f53\u524d \\(S[i - k..i - 1] = T[1..k]\\) \uff1b \u5982\u679c \\(S[i] \\neq T[k + 1]\\) \uff0c\u6211\u4eec\u5c31\u7528 \\(\\pi\\) \u51fd\u6570\u6765\u5b9e\u73b0\u5927\u5e45\u5ea6\u7684\u8df3\u8dc3\uff1b \u5426\u5219 \\(k' \\gets k + 1\\) \uff0c\u8868\u793a \\(S[i - k..i] = T[1..k + 1]\\) \uff1b \u5f53 \\(k = m\\) \u65f6\uff0c\u8bf4\u660e\u627e\u5230\u4e86\u4e00\u4e2a\u5339\u914d \\(S[i - m + 1..i] = T[1..m]\\) \u3002 \u4ee3\u7801\u5b9e\u73b0 1 2 3 4 5 6 7 8 9 10 for ( int i = 1 , k = 0 ; i <= n ; ++ i ) { while ( k > 0 && T [ k + 1 ] != S [ i ]) k = pi [ k ]; if ( T [ k + 1 ] == S [ i ]) ++ k ; if ( k == m ) { printf ( \"%d \\n \" , i - m + 1 ); // S[i - m + 1..i] = T[1..m] k = pi [ k ]; } } \u6b63\u786e\u6027 \u53ef\u4ee5\u8bc1\u660e\uff0c\u4e0a\u8ff0\u4ee3\u7801\u5b9e\u73b0\u662f\u6b63\u786e\u7684\u3002 \u65f6\u95f4\u590d\u6742\u5ea6 \u4f9d\u846b\u82a6\u753b\u74e2\u5730\u4f7f\u7528\u6c42\u524d\u7f00\u51fd\u6570\u6570\u7ec4\u65f6\u7684\u644a\u8fd8\u5206\u6790\u65b9\u6cd5\uff0c\u4e0d\u96be\u5f97\u51fa KMP \u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(n + m)\\) \u3002 \u7a7a\u95f4\u590d\u6742\u5ea6 \u4e0d\u96be\u53d1\u73b0 KMP \u7b97\u6cd5\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(n + m)\\) \u3002 \u4f8b\u9898 \u300cNOI2014\u300d\u52a8\u7269\u56ed \u300cPOJ 1961\u300dPeriod \u300cCF1200E\u300dCompress Words \u300cPOI2006\u300dOKR-Periods of Words \u5199\u5728\u6700\u540e","title":"\u524d\u7f00\u51fd\u6570\u4e0e KMP \u7b97\u6cd5"},{"location":"posts/lectures/kmp/#_1","text":"\u4e3a\u4e86\u66f4\u65b9\u4fbf\u5730\u63cf\u8ff0\u5b57\u7b26\u4e32\u76f8\u5173\u5185\u5bb9\uff0c\u6211\u4eec\u505a\u51fa\u4ee5\u4e0b\u89c4\u5b9a\uff1a \u5b57\u7b26\u4e32\u901a\u5e38\u7528 \\(S, T\\) \u7b49\u8868\u793a\uff0c \\(c\\) \u901a\u5e38\u8868\u793a\u4e00\u4e2a\u5b57\u7b26\uff0c \\(\\Sigma\\) \u8868\u793a\u5b57\u7b26\u96c6\uff1b \u5b57\u7b26\u4e32\u957f\u5ea6\u7528 \\(\\left|S\\right|\\) \u8868\u793a\uff1b \u5b57\u7b26\u96c6\u5927\u5c0f\u7528 \\(\\left|\\Sigma\\right|\\) \u8868\u793a\uff1b \\(S[l..r]\\) \u8868\u793a \\(S[l], S[l + 1], \\ldots, S[r - 1], S[r]\\) \uff1b \u7a7a\u4e32\u7528 \\(\\epsilon\\) \u8868\u793a\uff1b \\(S\\) \u662f \\(T\\) \u7684\u524d\u7f00\uff0c\u7528 \\(S \\sqsubset T\\) \u8868\u793a\uff1b \\(S\\) \u662f \\(T\\) \u7684\u540e\u7f00\uff0c\u7528 \\(S \\sqsupset T\\) \u8868\u793a\uff1b \\(S\\) \u7684\u7b2c \\(i\\) \u4e2a\u524d\u7f00\uff0c\u5373 \\(S[1..i]\\) \uff0c\u7528 \\(S_i\\) \u8868\u793a\u3002 \u7279\u6b8a\u5730\uff0c\u672c\u6587\u7684\u5b57\u7b26\u4e32\u4e0b\u6807\u3001 \\(\\pi\\) \u6570\u7ec4\u4e0b\u6807 \u5747\u4ece \\(1\\) \u5f00\u59cb \u3002 \u4e00\u4e9b\u4f8b\u5b50 \u5bf9\u4e8e \\(S = \\mathtt{ABCBAD}\\) \u800c\u8a00\uff1a \\(\\left|S\\right| = 6\\) \uff1b \\(\\left|\\Sigma\\right| = 4\\) \uff1b \\(S[2..4] = \\mathtt{BCBA}\\) \uff1b \\(S_4 = \\mathtt{ABCB}\\) \u3002","title":"\u5199\u5728\u524d\u9762"},{"location":"posts/lectures/kmp/#_2","text":"","title":"\u524d\u7f00\u51fd\u6570\u6570\u7ec4"},{"location":"posts/lectures/kmp/#_3","text":"\u5bf9\u4e8e\u4e00\u4e2a\u5b57\u7b26\u4e32 \\(S\\) \uff0c\u6211\u4eec\u5b9a\u4e49\u5176\u524d\u7f00\u51fd\u6570 \\(\\pi(S)\\) \u7684\u503c\u4e3a \\(S\\) \u7684\u6700\u957f\u76f8\u7b49\u7684\u771f\u524d\u7f00\u548c\u771f\u540e\u7f00\u7684\u957f\u5ea6\uff0c\u5373\uff1a \\[ \\begin{aligned} \\pi(S) & = \\mathop{\\operatorname{argmax}}\\limits_{k < \\left|S\\right|}\\{S[1..k] = S[\\left|S\\right| - k + 1..\\left|S\\right|]\\} \\\\ & = \\mathop{\\operatorname{argmax}}\\limits_{k < \\left|S\\right|}\\{S_k \\sqsupset S\\} \\end{aligned} \\] \u5bf9\u4e8e\u4e00\u4e2a\u5b57\u7b26\u4e32 \\(S\\) \uff0c\u6211\u4eec\u5b9a\u4e49\u5176\u524d\u7f00\u51fd\u6570\u6570\u7ec4 \\(\\pi\\) \u4e3a \\(\\pi[i] = \\pi(S_i)\\) \u3002 \\(\\pi[1] = ?\\) \u7279\u6b8a\u5730\uff0c\u5f53 \\(\\left|S\\right| = 1\\) \u65f6 \\(\\pi(S) = \\mathop{\\operatorname{argmax}}\\limits_{k < 1}\\{S[1..k] = S[2 - k..1]\\}\\) \u6b64\u65f6\u6709 \\(k = 0\\) \u6ee1\u8db3 \\(S[1..0] = S[2..1] = \\epsilon\\) \uff0c\u6545 \\(\\left|S\\right| = 1 \\Longrightarrow \\pi(S) = 0\\) \u3002 \u6027\u8d28 1 \\(\\pi(S_i) = \\pi[i] < i\\) \u3002 \u8bc1\u660e \u7531\u5b9a\u4e49\u77e5 \\(\\pi[i] < i\\) \uff0c\u5373\u5f97\u8bc1\u3002","title":"\u5b9a\u4e49"},{"location":"posts/lectures/kmp/#_4","text":"\u6839\u636e\u5b9a\u4e49\uff0c \\(\\pi[1] = 0\\) \uff1b \u5047\u8bbe\u6211\u4eec\u5faa\u73af\u5230\u4e86\u8981\u6c42 \\(\\pi[i]\\quad(i \\ge 2)\\) \uff0c\u4ee4 \\(k \\gets \\pi[i - 1]\\) \u3002 \u7531 \\(\\pi\\) \u6570\u7ec4\u7684\u5b9a\u4e49\u5f97\uff0c\u6b64\u65f6 \\(S[1..k] = S[i - k, i - 1]\\) \u3002 \u6211\u4eec\u73b0\u5728\u8981\u505a\u7684\uff0c\u5c31\u662f\u4ece \\(\\pi[1..i - 1]\\) \u9012\u63a8\u5230 \\(\\pi[i]\\) \uff1a \u8003\u8651\u5230 \\(\\pi\\) \u6570\u7ec4\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u4e0d\u65ad\u5730\u679a\u4e3e\u5171\u540c\u7684\u524d\u540e\u7f00\uff08\u5373\u4f7f\u7528 \\(k = \\pi[k]\\) \u6765\u8fed\u4ee3\uff09\u3002 \u7ed3\u675f\u8fd9\u4e2a\u8fed\u4ee3\uff0c\u6709\u4e14\u4ec5\u6709\u4e24\u79cd\u60c5\u51b5\uff1a \\(k = 0\\) \u6216 \\(S[k + 1] = S[i]\\) \u3002 \u5bf9\u4e8e\u524d\u8005\uff0c\u8bf4\u660e\u5bf9\u4e8e\u5b57\u7b26\u4e32 \\(S[1..i]\\) \uff0c\u4e0d\u5b58\u5728\u4efb\u4f55\u4e24\u4e2a\u771f\u524d\u7f00\u4e0e\u771f\u540e\u7f00\u76f8\u540c\uff0c \\(\\pi[i] = 0\\) \u3002 \u5bf9\u4e8e\u540e\u8005\uff0c\u8bf4\u660e\u6211\u4eec\u627e\u5230\u4e86\u4e00\u4e2a \\(k\\) \uff0c\u4f7f\u5f97 \\(S[1..k + 1] = S[i - k..i]\\) \uff0c\u6839\u636e\u5b9a\u4e49\uff0c\u6709 \\(\\pi[i] = k + 1\\) \u3002 \u81f3\u6b64\uff0c\u6211\u4eec\u6c42\u51fa\u4e86\u5b57\u7b26\u4e32 \\(S\\) \u7684\u524d\u7f00\u51fd\u6570\u6570\u7ec4 \\(\\pi\\) \u3002","title":"\u7b97\u6cd5\u6d41\u7a0b"},{"location":"posts/lectures/kmp/#_5","text":"1 2 3 4 5 6 7 8 9 10 11 void calcPi ( char * S ) { pi [ 1 ] = 0 ; int len = strlen ( S + 1 ); for ( int i = 2 , k = 0 ; i <= len ; ++ i ) { while ( k > 0 && S [ k + 1 ] != S [ i ]) k = pi [ k ]; if ( S [ k + 1 ] == S [ i ]) ++ k ; pi [ i ] = k ; } }","title":"\u4ee3\u7801\u5b9e\u73b0"},{"location":"posts/lectures/kmp/#_6","text":"\u5f15\u7406 1\uff08\u540e\u7f00\u91cd\u53e0\u5f15\u7406\uff09 \u5bf9\u4e8e \\(x, y\\) \u6ee1\u8db3 \\(x \\sqsupset z, y \\sqsupset z\\) \u800c\u8a00\uff0c\u6709\uff1a \u82e5 \\(\\left|x\\right| \\le \\left|y\\right|\\) \uff0c\u5219 \\(x \\sqsupset y\\) \uff1b \u82e5 \\(\\left|x\\right| \\ge \\left|y\\right|\\) \uff0c\u5219 \\(y \\sqsupset x\\) \uff1b \u82e5 \\(\\left|x\\right| = \\left|y\\right|\\) \uff0c\u5219 \\(x = y\\) \u3002 \u8bc1\u660e \u8fc7\u4e8e\u663e\u7136\uff0c\u8bc1\u660e\u7565\u3002 \u8bbe \\[ \\pi^{\\star}[q] = \\\\{\\pi[q], \\pi^{(2)}[q], \\cdots, \\pi^{(t)}[q]\\\\} \\] \u5176\u4e2d \\[ \\pi^{(i)}[q] = \\begin{cases}q & i = 0 \\\\\\\\ \\pi[\\pi^{(i - 1)}[q]] & i \\ge 1\\end{cases} \\] \u5f53 \\(\\pi^{(t)}[q] = 0\\) \u65f6 \\(\\pi^{\\star}[q]\\) \u4e2d\u7684\u5e8f\u5217\u7ec8\u6b62\u3002 \u5f15\u7406 2\uff08\u524d\u7f00\u51fd\u6570\u8fed\u4ee3\u5f15\u7406\uff09 \u5bf9\u4efb\u610f\u957f\u5ea6\u4e3a \\(n\\) \u7684\u5b57\u7b26\u4e32 \\(S\\) \uff0c\u6709 \\[ \\forall q \\in [1, n], \\pi^{\\star}[q] = \\{k: k < q \\land S_k \\sqsupset S_q\\} \\] \u8bc1\u660e \u5148\u8bc1\u660e \\(\\pi^{\\star}[q] \\subseteq \\{k:k < q \\land S_k \\sqsupset S_q\\}\\) \uff0c \u5373\u8bc1\u660e \\(\\forall x \\in \\pi^{\\star}[q], x < q \\land S_x \\sqsupset S_q\\) \u3002 \u4efb\u53d6 \\(x \\in \\pi^{\\star}[q]\\) \uff0c\u4e0d\u59a8\u8bbe \\(x = \\pi^{u}[q] \\quad (u > 0)\\) \uff0c\u4e0b\u9762\u901a\u8fc7\u5bf9 \\(u\\) \u7684\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u660e\u547d\u9898\u6210\u7acb\u3002 \uff08\u57fa\u7840\uff09\u5f53 \\(u = 1\\) \u65f6\uff0c \\(x = \\pi[q]\\) \uff0c\u7531 \\(\\pi\\) \u6570\u7ec4\u7684\u5b9a\u4e49\u53ef\u77e5 \\(\\pi[q] < q \\land S_{\\pi[q]} \\sqsupset S_q\\) \u3002 \uff08\u5047\u8bbe\uff09\u5047\u8bbe\u5f53 \\(u = v\\) \u65f6 \\(\\pi^{v}[q] < q \\land S_{\\pi^{v}[q]} \\sqsupset S_q\\) \u3002 \uff08\u63a8\u5bfc\uff09\u5219\u5f53 \\(u = v + 1\\) \u65f6\uff0c \\(\\pi^{v + 1}[q] = \\pi[\\pi^{v}[q]] < \\pi^{v}[q] < q\\) \uff08\u6027\u8d28 1\uff09\uff1b \\(S_{\\pi^{v + 1}[q]} \\sqsupset S_{\\pi^{v}[q]} \\sqsupset S_q\\) \uff08\u7531\u6027\u8d28 1 \u5f97\u5230\u4e0b\u6807\u7684\u5927\u5c0f\u5173\u7cfb\uff0c\u7531\u5f15\u7406 1 \u5f97\u5230\u524d\u7f00\u4e4b\u95f4\u7684\u5173\u7cfb\uff09 \u56e0\u6b64 \\(\\forall x \\in \\pi^{\\star}[q], x < q \\land S_x \\sqsupset S_q\\) \u3002 \u518d\u8bc1\u660e \\(\\{k:k < q \\land S_k \\sqsupset S_q\\} \\subseteq \\pi^{\\star}[q]\\) \uff0c \u5373\u8bc1\u660e \\(\\forall x \\in \\\\{k:k < q \\land S_x \\sqsupset S_q\\\\}, x \\in\\pi^{\\star}[q]\\) \u8003\u8651\u4f7f\u7528\u53cd\u8bc1\u6cd5\u6765\u8bc1\u660e\u547d\u9898\u6210\u7acb\u3002 \u5047\u8bbe\u96c6\u5408 \\(M = \\{k:k < q \\land S_k \\sqsupset S_q\\} - \\pi^{\\star}[q]\\) \u975e\u7a7a\uff0c \\(j\\) \u662f \\(M\\) \u4e2d\u7684\u6700\u5927\u503c\u3002 \\(\\because\\) \\(\\pi[q]\\) \u662f \\(\\{k:k < q \\land S_x \\sqsupset S_q\\}\\) \u4e2d\u7684\u6700\u5927\u503c\uff0c\u4e14 \\(j \\in \\{k:k < q \\land S_x \\sqsupset S_q\\}\\) \\(\\therefore j < \\pi[q], S_j \\sqsupset S_q\\) \u53c8 \\(\\because \\pi[q] \\in \\pi^{\\star}[q]\\) \\(\\therefore \\exists j' \\in \\pi^{\\star}[q], \\text{s.t. }j' > j\\) \u8bbe \\(j'\\) \u8868\u793a \\(\\pi^{\\star}[q]\\) \u4e2d\u6bd4 \\(j\\) \u5927\u7684\u6700\u5c0f\u6574\u6570\u3002 \\(\\because \\{k:k < q \\land S_k \\sqsupset S_q\\} \\subseteq \\pi^{\\star}[q]\\) \u4e14 \\(j' \\in \\pi^{\\star}[q]\\) \\(\\therefore S_{j'} \\sqsupset S_q\\) \\(\\because j' > j\\) \u4e14 \\(j\\) \u662f\u5c0f\u4e8e \\(j'\\) \u7684\u6700\u5927\u503c \\(\\therefore S_j \\sqsupset S_{j'}\\) \uff08\u5f15\u7406 1\uff09 \u7531 \\(\\pi\\) \u6570\u7ec4\u7684\u5b9a\u4e49\u77e5 \\(\\pi[j'] = j\\) \\(\\because j' \\in \\pi^{\\star}[q]\\) \\(\\therefore j = \\pi[j'] \\in \\pi^{\\star}[q]\\) \uff0c\u4e0e\u5047\u8bbe\u77db\u76fe \u56e0\u6b64 \\(\\{k:k < q \\land S_k \\sqsupset S_q\\} \\subseteq \\pi^{\\star}[q]\\) \u3002 \u7efc\u4e0a\u6240\u8ff0\uff0c\u5bf9\u4efb\u610f\u957f\u5ea6\u4e3a \\(n\\) \u7684\u5b57\u7b26\u4e32 \\(S\\) \uff0c\u6709 \\(\\forall q \\in [1, n], \\pi^{\\star}[q] = \\{k: k < q \\land S_k \\sqsupset S_q\\}\\) \u3002 \u5f15\u7406 3 \u5bf9\u4efb\u610f\u957f\u5ea6\u4e3a \\(n\\) \u7684\u5b57\u7b26\u4e32 \\(S\\) \uff0c\u6709 \\(\\forall q \\in [1, n]\\) \uff0c\u82e5 \\(\\pi[q] > 0\\) \uff0c\u5219 \\(\\pi[q] - 1 \\in \\pi^{\\star}[q - 1]\\) \u3002 \u8bc1\u660e \u4ee4 \\(x = \\pi[q] > 0\\) \uff0c\u5219 \\(x < q, S_x \\sqsupset S_q\\) \\(\\because x > 0\\) \uff0c\u5219 \\(x - 1\\) \u6709\u610f\u4e49 \\(\\therefore x - 1 < q - 1, S_{x - 1} \\sqsupset S_{q - 1}\\) \uff08\u628a \\(S_x\\) \u548c \\(S_q\\) \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u53bb\u6389\uff09 \u7531\u5f15\u7406 2 \u77e5 \\(x - 1 \\in \\pi^{\\star}[q - 1]\\) \\(\\therefore \\forall q \\in [1, n] \\land \\pi[q] > 0,\\pi[q] - 1 \\in \\pi^{\\star}[q - 1]\\) \u5bf9 \\(q \\in [2, n]\\) \u5b9a\u4e49\u5b50\u96c6 \\(E_{q - i} \\subseteq \\pi^{\\star}[q - 1]\\) \u4e3a\uff1a \\[ E_{q - 1} = \\{k\\in\\pi^{\\star}[q - 1]:S_{k + 1} = S_k\\} \\] \u5219\u6709\uff1a \\[ \\begin{aligned} E_{q - 1} & = \\{k\\in\\pi^{\\star}[q - 1]:S_{k + 1} = S_k\\} \\\\ & = \\{k: k < q - 1, S_k \\sqsupset S_{q - 1}, S[k + 1] = S[q]\\} \\\\ & = \\{k: k < q - 1, S_{k + 1} \\sqsupset S_q\\} \\end{aligned} \\] \u56e0\u6b64\uff0c \\(E_{q - 1}\\) \u662f\u7531 \\(\\pi^{\\star}[q - 1]\\) \u4e2d\u7684\u503c\u7ec4\u6210\u7684\u3001\u80fd\u6ee1\u8db3 \\(S_{k + 1}\\) \u4e0e \\(S_q\\) \u7684\u67d0\u4e2a\u540e\u7f00\u76f8\u7b49\u7684 \\(k\\) \u7ec4\u6210\u7684\u96c6\u5408\u3002 \u63a8\u8bba 1 \u5bf9\u4efb\u610f\u957f\u5ea6\u4e3a \\(n\\) \u7684\u5b57\u7b26\u4e32 \\(S\\) \uff0c\u6709 \\[ \\forall q \\in [2, n],\\pi[q] = \\begin{cases}0 & E_{q - 1} = \\varnothing \\\\ 1 + \\max\\{k \\in E_{q - 1}\\} & E_{q - 1} \\neq \\varnothing\\end{cases} \\] \u8bc1\u660e \u5f53 \\(E_{q - 1} = \\varnothing\\) \u65f6\uff0c\u4e0d\u5b58\u5728\u4efb\u4f55\u4e00\u4e2a \\(k \\in \\pi^{\\star}[q - 1]\\) \uff0c\u4f7f\u5f97 \\(S_{k + 1} \\sqsupset S_q\\) \u3002 \u663e\u7136\u6b64\u65f6 \\(\\pi[q]\\) \u53ea\u80fd\u4e3a \\(0\\) \u3002 \u5f53 \\(E_{q - 1} \\neq \\varnothing\\) \u65f6\uff0c \\(\\forall k \\in E_{q - 1}, k < q - 1 \\land S_{k + 1} \\sqsupset S_q \\Longrightarrow k + 1 < q\\) \u5219\u7531 \\(\\pi[q]\\) \u7684\u5b9a\u4e49\uff0c \\(k\\) \u662f\u62d3\u5c55\u5230 \\(S_q\\) \u7684\u67d0\u4e00\u540e\u7f00\u7684\u5907\u9009\u9879\uff0c \\(\\pi[q] \\ge 1 + \\max\\{k \\in E_{q - 1}\\}\\) \u3002 \u6ce8\u610f\u5230\u6b64\u65f6 \\(\\pi[q] > 0\\) \uff0c\u8bbe \\(r = \\pi[q] - 1\\) \u3002 \u5219 \\(r + 1 = \\pi[q] < q, S_{r + 1} = S_{\\pi[q]} \\sqsupset S_q\\) \u3002 \\(\\because r + 1 > 0\\) \\(\\therefore S_{r + 1} = S_q\\) \u7531\u5f15\u7406 3 \u53ef\u5f97 \\(r = \\pi[q] - 1 \\in \\pi^{\\star}[q - 1]\\) \\(\\therefore r \\in E_{q - 1}\\) \\(\\therefore \\pi[q] - 1 = r \\le \\max\\{k \\in E_{q - 1}\\}\\) \u5373 \\(\\pi[q] \\le 1 + \\max\\{k \\in E_{q - 1}\\}\\) \u7efc\u4e0a\u6240\u8ff0\uff0c\u5f53 \\(E_{q - 1} \\neq \\varnothing\\) \uff0c \\(\\pi[q] = 1 + \\max\\{k \\in E_{q - 1}\\}\\) \u3002 \u518d\u6765\u770b\u770b\u4ee3\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 void calcPi ( char * S ) { pi [ 1 ] = 0 ; int len = strlen ( S + 1 ); for ( int i = 2 , k = 0 ; i <= len ; ++ i ) { while ( k > 0 && S [ k + 1 ] != S [ i ]) k = pi [ k ]; if ( S [ k + 1 ] == S [ i ]) ++ k ; pi [ i ] = k ; } } \u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u4f7f\u7528\u5faa\u73af\u4e0d\u53d8\u5f0f\u6765\u8bc1\u660e\u4e0a\u8ff0\u4ee3\u7801\u7684\u6b63\u786e\u6027\u3002 \u8bc1\u660e \u521d\u59cb\u5316 \u5728\u7b2c 4 \u884c\u7684\u8fed\u4ee3\u5f00\u59cb\u524d\uff0c\u6709 \\(i = 1, k = \\pi[i] = 0\\) \uff0c\u4e0d\u53d8\u5f0f\u6210\u7acb\u3002 \u4fdd\u6301 \u5728\u6bcf\u6b21\u8fed\u4ee3\u5f00\u59cb\u524d\uff0c\u6709 \\(k = \\pi[i - 1]\\) \uff1a \u82e5\u662f\u7b2c\u4e00\u6b21\u8fed\u4ee3\uff0c\u6b64\u7b49\u5f0f\u7531\u7b2c 4 \u884c\u4fdd\u8bc1\uff1b \u5176\u4f59\u8fed\u4ee3\u5747\u7531\u7b2c 9 \u884c\u4fdd\u8bc1\u3002 \u63a5\u4e0b\u6765\u8981\u8bc1\u660e\u6bcf\u6b21\u8fed\u4ee3\u7ed3\u675f\u540e\u5747\u6709 \\(k = \\pi[i]\\) \u6210\u7acb\u3002 \u82e5 \\(k \\neq \\pi[i]\\) \uff0c\u5219\u4f1a\u5728\u7b2c 5-8 \u884c\u5c06 \\(k\\) \u8c03\u6574\u81f3 \\(\\pi[i]\\) \u3002 \u7b2c 5 \u884c\u7684 while \u5faa\u73af\u904d\u5386\u6bcf\u4e00\u4e2a \\(k \\in \\pi^{\\star}[i - 1]\\) \uff0c\u76f4\u81f3\u627e\u5230\u4e00\u4e2a \\(k\\) \uff0c\u4f7f\u5f97 \\(S[k + 1] = S[i]\\) \u3002\uff08\u5f15\u7406 2\uff09 \u82e5\u627e\u4e0d\u5230\u8fd9\u6837\u7684\u503c\uff0c\u5219\u5728\u7b2c 7 \u884c \\(k = 0\\) \u3002 \u82e5\u627e\u5230\u4e86\u8fd9\u6837\u7684\u503c\uff0c\u6b64\u65f6 \\(k\\) \u4e3a\u6ee1\u8db3\u6761\u4ef6\u7684\u96c6\u5408\u4e2d\u7684\u6700\u5927\u503c\uff0c\u5e94\u5c06 \\(\\pi[i] \\gets k + 1\\) \u3002\uff08\u63a8\u8bba 1\uff09 \u7b2c 9 \u884c\u7684\u8d4b\u503c\u8bed\u53e5\u4f7f\u5f97 \\(k = \\pi[i]\\) \u6052\u6210\u7acb\u3002 \u7ec8\u6b62 \u5f53 \\(i = n + 1\\) \u65f6\uff0c\u8fed\u4ee3\u7ec8\u6b62\uff0c\u6b64\u65f6\u6211\u4eec\u6c42\u51fa\u4e86 \\(\\pi[1..n]\\) \u3002 \u81f3\u6b64\uff0c\u7b97\u6cd5\u7ed3\u675f\u3002 \u56e0\u6b64\uff0c\u4e0a\u8ff0\u4ee3\u7801\u5b9e\u73b0\u80fd\u6b63\u786e\u5730\u6c42\u51fa\u5b57\u7b26\u4e32 \\(S\\) \u7684\u524d\u7f00\u51fd\u6570\u6570\u7ec4\u3002","title":"\u6b63\u786e\u6027"},{"location":"posts/lectures/kmp/#_7","text":"\u4e0d\u96be\u53d1\u73b0\uff0c\u7b2c 7-9 \u884c\u4ee3\u7801\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5747\u4e3a \\(O(n)\\) \uff0c\u552f\u4e00\u68d8\u624b\u7684\u662f\u7b2c 6-7 \u884c\u4ee3\u7801\u3002 \u8003\u8651 \\(k\\) \u7684\u53d8\u5316\uff0c \\(k\\) \u5728\u7b2c 7-8 \u884c\u589e\u52a0\u7684\u6b21\u6570\u4e0d\u8d85\u8fc7 \\(n\\) \u6b21\uff0c\u5373 \\(k \\le n\\) \uff1b \\(k\\) \u5728\u7b2c 6 \u884c\u7684\u64cd\u4f5c\u4e2d\uff0c\u56e0\u4e3a\u6709 \\(\\pi(S_i) < i\\) \u7684\u6027\u8d28\uff0c\u5bfc\u81f4\u6bcf\u6b21\u8fed\u4ee3\u81f3\u5c11\u4f7f \\(k\\) \u51cf\u5c0f \\(1\\) \uff0c\u5373\u6700\u591a\u8fed\u4ee3 \\(n\\) \u6b21\u3002 \u7efc\u4e0a\u6240\u8ff0\uff0c\u7528\u4e0a\u8ff0\u65b9\u6cd5\u6c42\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u524d\u7f00\u51fd\u6570\u6570\u7ec4\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(n)\\) \u3002","title":"\u65f6\u95f4\u590d\u6742\u5ea6"},{"location":"posts/lectures/kmp/#_8","text":"\u6613\u77e5\u7528\u6b64\u79cd\u65b9\u6cd5\u6c42\u524d\u7f00\u51fd\u6570\u6570\u7ec4\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(n)\\) \u3002","title":"\u7a7a\u95f4\u590d\u6742\u5ea6"},{"location":"posts/lectures/kmp/#kmp","text":"","title":"KMP \u7b97\u6cd5"},{"location":"posts/lectures/kmp/#_9","text":"\u6211\u4eec\u4e3e\u4e00\u4e2a\u4f8b\u5b50\uff1a\u7528 \\(S = \\mathtt{CCFCCFMONEY}\\) \u88ab \\(T = \\mathtt{CCFCCFSB}\\) \u5339\u914d\u3002 \u6211\u4eec\u5b9a\u4e49\u4e24\u4e2a\u6307\u9488 \\(i,k\\) \uff0c\u8868\u793a \\(S[i - k..i - 1] = T[1..k]\\) \u3002 \u6211\u4eec\u8981\u62d3\u5c55\u7684\uff0c\u5c31\u662f \\(S[i]\\) \u4e0e \\(T[k + 1]\\) \u4e4b\u95f4\u7684\u5173\u7cfb\u3002 \u9996\u5148\u6211\u4eec\u8003\u8651\u6734\u7d20\u7b97\u6cd5\u7684\u5f0a\u7aef\uff1a\u5f53\u4f60\u5339\u914d\u5230\u4e86 \\(i = 8, k = 7\\) \u65f6\uff1a $$ \\begin{aligned} S & = \\mathtt{\\color{green}CCFXCCF\\color{red}M\\color{black}ONEY} \\\\ T & = \\mathtt{\\color{green}CCFXCCF\\color{red}S\\color{black}B} \\\\ \\text{index} & =\\mathtt{123456789} \\end{aligned} $$ \u4f60\u53d1\u73b0 \\(S[i] = S[8] = \\mathtt{M}\\) \uff0c\u53ef \\(T[k + 1] = T[8] = \\mathtt{S}\\) \uff0c\u6211\u4eec\u524d\u529f\u5c3d\u5f03\uff0c\u53ea\u80fd\u5c06 \\(T\\) \u5f80\u53f3\u5e73\u79fb\u4e00\u683c\u3002 \u800c\u4e14\u8981\u91cd\u65b0\u5f00\u59cb\uff1a \\(i = 1, k = 1\\) \u3002 $$ \\begin{aligned} S & = \\mathtt{CCFXCCFMONEY} \\\\ T & = \\mathtt{\\text{ }CCFXCCFSB} \\\\ \\text{index} & =\\mathtt{123456789} \\end{aligned} $$ \u663e\u7136\u6734\u7d20\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(nm)\\) \u3002 \u518d\u8003\u8651\u4f7f\u7528\u524d\u7f00\u51fd\u6570 \\(\\pi\\) \u6765\u4f18\u5316\u5339\u914d\u7684\u8fc7\u7a0b\u3002 \u4e0d\u96be\u6c42\u51fa \\(T\\) \u7684\u524d\u7f00\u6570\u7ec4 \\(\\pi[1..n] = \\\\{0, 1, 0, 0, 1, 2, 3, 0, 0\\\\}\\) \u3002 \u8003\u8651\u524d\u7f00\u6570\u7ec4\u7684\u610f\u4e49\uff1a \\(T_i\\) \u7684\u6700\u957f\u7684\u76f8\u7b49\u7684\u524d\u540e\u7f00\u957f\u5ea6\u3002 \u4f60\u77e5\u9053\u4e86\u5f53 \\(i = 8, k = 7\\) \u65f6\uff0c\u6709 \\(S[1..7] = T[1..7]\\) \uff0c\u800c\u4e14 \\(T[1..3] = T[5..7]\\) \u3002 \u5728\u4e0a\u8ff0\u7684\u4f8b\u5b50\u4e2d\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u53ef\u4ee5\u628a \\(T[1..3]\\) \u8fd9\u4e2a\u5730\u65b9\u5339\u914d\u5230\u7684 \\(\\mathtt{\\color{green}CCF}\\) \u79fb\u52a8\u5230 \\(S[5..8]\\) \u53bb\u3002 \u8fd9\u6837\u5c31\u76f4\u63a5\u8282\u7701\u4e86\u4e09\u6b21\u79fb\u52a8\u3002 \u603b\u7ed3\u4e00\u4e0b\u4f7f\u7528\u524d\u7f00\u51fd\u6570 \\(\\pi\\) \u65f6\u6211\u4eec\u7684\u5339\u914d\u8fc7\u7a0b\uff1a \u4f7f\u7528 \\(i, k\\) \u6765\u8868\u793a\u5f53\u524d \\(S[i - k..i - 1] = T[1..k]\\) \uff1b \u5982\u679c \\(S[i] \\neq T[k + 1]\\) \uff0c\u6211\u4eec\u5c31\u7528 \\(\\pi\\) \u51fd\u6570\u6765\u5b9e\u73b0\u5927\u5e45\u5ea6\u7684\u8df3\u8dc3\uff1b \u5426\u5219 \\(k' \\gets k + 1\\) \uff0c\u8868\u793a \\(S[i - k..i] = T[1..k + 1]\\) \uff1b \u5f53 \\(k = m\\) \u65f6\uff0c\u8bf4\u660e\u627e\u5230\u4e86\u4e00\u4e2a\u5339\u914d \\(S[i - m + 1..i] = T[1..m]\\) \u3002","title":"\u7b97\u6cd5\u6d41\u7a0b"},{"location":"posts/lectures/kmp/#_10","text":"1 2 3 4 5 6 7 8 9 10 for ( int i = 1 , k = 0 ; i <= n ; ++ i ) { while ( k > 0 && T [ k + 1 ] != S [ i ]) k = pi [ k ]; if ( T [ k + 1 ] == S [ i ]) ++ k ; if ( k == m ) { printf ( \"%d \\n \" , i - m + 1 ); // S[i - m + 1..i] = T[1..m] k = pi [ k ]; } }","title":"\u4ee3\u7801\u5b9e\u73b0"},{"location":"posts/lectures/kmp/#_11","text":"\u53ef\u4ee5\u8bc1\u660e\uff0c\u4e0a\u8ff0\u4ee3\u7801\u5b9e\u73b0\u662f\u6b63\u786e\u7684\u3002","title":"\u6b63\u786e\u6027"},{"location":"posts/lectures/kmp/#_12","text":"\u4f9d\u846b\u82a6\u753b\u74e2\u5730\u4f7f\u7528\u6c42\u524d\u7f00\u51fd\u6570\u6570\u7ec4\u65f6\u7684\u644a\u8fd8\u5206\u6790\u65b9\u6cd5\uff0c\u4e0d\u96be\u5f97\u51fa KMP \u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(n + m)\\) \u3002","title":"\u65f6\u95f4\u590d\u6742\u5ea6"},{"location":"posts/lectures/kmp/#_13","text":"\u4e0d\u96be\u53d1\u73b0 KMP \u7b97\u6cd5\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(n + m)\\) \u3002","title":"\u7a7a\u95f4\u590d\u6742\u5ea6"},{"location":"posts/lectures/kmp/#_14","text":"\u300cNOI2014\u300d\u52a8\u7269\u56ed \u300cPOJ 1961\u300dPeriod \u300cCF1200E\u300dCompress Words \u300cPOI2006\u300dOKR-Periods of Words","title":"\u4f8b\u9898"},{"location":"posts/lectures/kmp/#_15","text":"","title":"\u5199\u5728\u6700\u540e"},{"location":"posts/lectures/pairing-heap/","text":"","title":"\u914d\u5bf9\u5806"},{"location":"posts/mood/","text":"index","title":"\u6982\u8ff0"},{"location":"posts/mood/#index","text":"","title":"index"},{"location":"posts/mood/2020-08/","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout 1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"2020.08"},{"location":"posts/mood/2020-08/#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"posts/mood/2020-08/#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"posts/mood/2020-08/#project-layout","text":"1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"Project layout"},{"location":"posts/mood/2020-09/","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout 1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"2020.09"},{"location":"posts/mood/2020-09/#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"posts/mood/2020-09/#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"posts/mood/2020-09/#project-layout","text":"1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"Project layout"},{"location":"posts/whk/","text":"index","title":"\u6982\u8ff0"},{"location":"posts/whk/#index","text":"","title":"index"},{"location":"posts/whk/maths/","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout 1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"\u6570\u5b66"},{"location":"posts/whk/maths/#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"posts/whk/maths/#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"posts/whk/maths/#project-layout","text":"1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \\(f(x) = \\sum_{i = 1}^{j}\\)","title":"Project layout"}]}